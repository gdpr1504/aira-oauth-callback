<!DOCTYPE html>
<html>
<head>
  <title>OAuth Callback</title>
</head>
<body>
  <p>Completing sign-in...</p>

  <script>
    (function() {
      // Parse URL hash for access_token (implicit flow)
      const hash = window.location.hash.substring(1);
      const params = new URLSearchParams(hash);
      const accessToken = params.get("access_token");

      if (accessToken) {
        // Send token to extension via postMessage
        window.opener.postMessage({ type: "OAUTH_TOKEN", token: accessToken }, "*");

        // Optional: close window after sending token
        window.close();
      } else {
        console.error("No access token found in URL.");
      }
    })();
  </script>
</body>
</html>
